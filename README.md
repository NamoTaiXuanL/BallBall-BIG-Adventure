# 球球大冒险 (BallBall Big Adventure) v4.3.6

一款2D平台动作冒险游戏，玩家控制一个具有特殊能力的球球角色，在广阔的地图中探索、战斗、收集资源并购买属性增强。

## 🎮 游戏特色

- **流畅的移动系统**：支持滚动、跳跃、二段跳和冲刺
- **🛒 购买系统**：使用金币购买属性增强，提升角色能力
- **💪 属性增强系统**：基础伤害等属性可通过购买永久提升
- **🎯 怪物等级系统**：基于距离的动态等级计算，提供渐进式挑战
- **🛡️ 安全区系统**：智能化的安全区生成和管理机制，提供战略休息点
- **智能怪物生成**：基于玩家移动速度的动态生成系统
- **丰富的敌人类型**：7种不同行为模式的怪物，包括精英怪物系统
- **动态地图生成**：无限探索的程序化地图
- **战斗系统**：自动瞄准和多样化的攻击方式
- **🔥 风火轮技能**：玩家周围环绕火焰球，提供持续伤害和防护
- **⚡ 激光技能**：强力激光束攻击，可穿透多个敌人
- **🌊 狂潮模式**：所有怪物攻击欲望增强，战斗更加激烈
- **📊 等级血条系统**：不同等级怪物显示不同颜色血条，直观显示威胁等级

## 📋 版本历史

### 版本 4.3.6 - 金币属性系统非持久化修复版 (最新) 🔄
- 🔄 **数据重置系统** - 移除localStorage持久化存储，每次刷新重新开始
  - 金币系统重置：页面刷新后金币从0开始计算
  - 属性系统重置：购买的属性增加值重新归零
  - 购买记录重置：购买统计数据不再保存
  - 公平游戏体验：避免累积优势，每次都是全新开始
- 🎮 **100级以上怪物系统全面升级** - 循环体型变化和视觉效果增强
  - 循环体型变化：每50级一个循环，前25级增长后25级缩小
  - 圆环系统升级：厚度增加、渐变填充、间距优化
  - 球体系统：每级增加球体、发光效果、高光反射
  - 怪物类型差异：不同颜色怪物的球体分布规律不同
- 🐛 **血量计算系统修复** - 修正血量计算顺序和调试面板显示

### 版本 4.3.1 - 购买系统与属性增强版 🛒
- 🛒 **购买系统全新上线** - 完整的商品购买和属性增强系统
  - B键触发购买界面：屏幕下方1/5区域显示商品列表
  - 基础伤害购买：1000金币购买10点基础伤害增加值
  - 数字键快速购买：支持数字键1快速购买商品
  - 金币余额显示：实时显示当前金币数量和购买状态
- 💪 **属性增强系统** - 独立的玩家属性管理模块
  - 基础伤害增强：购买的伤害加成应用到所有攻击方式
  - 持久化存储：属性数据自动保存到本地存储
  - 扩展性设计：支持未来添加更多属性类型
- ⚔️ **伤害系统集成** - 所有攻击方式集成属性加成
  - 普通射击、散射子弹、三相之力、风火轮技能全面升级
- 🐛 **Bug修复** - 修复购买系统接口错误和风火轮伤害NaN问题

### 版本 4.1.8 - 安全区系统优化版 🛡️
- 🛡️ **安全区系统全面优化** - 智能化的安全区生成和管理机制
  - 生成条件提升：击杀要求从20只提升到100只怪物
  - 数量限制：全地图最多同时存在3个安全区
  - 距离控制：附近区域不会重复生成安全区（最小距离2个区域）
  - 自动清理：超过数量限制时自动清理最旧的安全区
- 🤖 **怪物AI优化** - 玩家进入安全区后怪物智能回到原位置
  - 原位置记录：怪物生成时记录出生坐标
  - 回归状态：新增return状态，平滑移动回到出生点
  - 行为优化：避免怪物在安全区边缘静止不动
- 🛡️ **伤害免疫系统** - 玩家在安全区内完全免疫所有伤害
  - 敌人碰撞、刺球、投射物伤害全面免疫
  - 保护提示：受保护时20%概率显示提示信息
- ⚖️ **游戏平衡性** - 提高安全区生成门槛，增加策略性

### 版本 4.0.0 - 怪物等级系统重构版 🎯
- 🎯 **怪物等级系统全面重构** - 基于距离的动态等级计算系统
  - 距离等级计算：每1000像素距离增加1个等级，提供渐进式挑战
  - 全属性缩放：血量、攻击力、移动速度、体积、检测范围全面等级化
  - 视觉等级指示：血条颜色和厚度根据等级动态变化
  - 奖励倍增机制：高等级怪物提供更多经验和积分奖励
- ⚖️ **游戏平衡性优化** - 从指数增长改为线性增长，避免后期过度困难
  - 攻击力缩放：从每级30%降至5%，保持挑战性同时避免秒杀
  - 血量增长：合理的线性增长，确保战斗时长适中
  - 精英怪生成系统修复：恢复精英怪物的正常生成和挑战性
- 🎨 **等级血条系统** - 全新的等级可视化系统
  - 不同等级显示不同颜色：绿色(1级) → 黄色(2-3级) → 橙色(4-5级) → 红色(6级+)
  - 血条厚度随等级增加，直观显示怪物威胁等级
  - 精英怪特殊标识，紫色血条突出显示
- 🛠️ **技术架构升级** - 模块化buff系统和性能优化

### 版本 3.9.6 - 分数显示优化版
- 🎯 **分数显示系统重构** - 全新的多实例分数显示机制
  - 每次分数变动在主角附近随机位置生成新的分数显示
  - 最多同时显示2个分数实例，避免视觉混乱
  - 快速淡出效果(1.2秒生命周期)，30%时开始淡出
  - 更大字体(32-40px)，无背景干扰，纯净文字显示
- ✨ **视觉体验提升** - 分数显示更加简洁清晰
  - 随机位置分布，每个实例有独特的颜色和大小
  - 轻微浮动效果替代抖动，更加优雅
  - 300ms更新间隔限制，确保用户能清楚看到数值变化
- 🔧 **系统稳定性** - 修复分数显示相关的渲染和逻辑问题

### 版本 3.9.3 - 三相之力完整版
- 🔱 **三相之力buff系统** - 全新的强化buff机制
  - 激活后子弹变为三发同时射击，覆盖更大范围
  - 风火轮从4个正方形排列变为3个三角形排列，半径和球体尺寸显著增大
  - 激光技能变为三股同时发射，伤害和覆盖范围大幅提升
  - 玩家获得金光闪烁视觉效果，彰显强化状态
- ⚡ **视觉效果完善** - 三相之力所有技能的视觉表现完全实现
  - 三股激光同时渲染，提供震撼的视觉冲击
  - 风火轮尺寸动态调整，三相之力状态下更加壮观
- 🔧 **系统稳定性** - 修复三相之力相关的渲染和逻辑问题

### 版本 3.8.0 - 状态圆环与免控系统版
- 🎯 **状态圆环系统** - 主角身上显示生命、魔力、怒气、精力四种状态圆环
  - 圆环根据数值百分比动态变化，分层显示避免重叠
  - 不同颜色区分：生命(红色)、魔力(蓝色)、怒气(橙色)、精力(绿色)
- 🛡️ **风火轮免控增强** - 风火轮技能提供完整的控制免疫效果
  - 激活时立即解除所有控制状态(减速、定身等)
  - 持续期间完全免疫控制敌人引力圈和精英敌人引力场
  - 确保移动速度不受任何控制效果影响
- 🎨 **视觉优化** - 风火轮范围调整(80→120)避免与状态圆环重合
- 🔧 **系统完善** - 修复风火轮免控功能不完整的问题，提升战斗体验

### 版本 3.7.8 - 精英怪物系统完善版
- 👹 **精英怪物外观区别度** - 四种精英怪物子类型拥有独特颜色主题和视觉效果
  - Graviton（引力型）：深紫色主题，脉动引力波效果
  - Destroyer（毁灭型）：深红色主题，火焰粒子效果
  - Guardian（守护型）：深蓝色主题，护盾光环效果
  - Vortex（漩涡型）：深绿色主题，旋转能量效果
- ⚡ **F键闪现增强** - 闪现距离从200提升至600，移动更灵活
- 🔥 **激光技能全面改进** - 射程加倍(800→1600)，魔力消耗增加，移除冷却限制
- 🎯 **精英怪物生成修复** - 修复精英怪物统计追踪和生成逻辑问题
- 🎨 **视觉体验提升** - 精英怪物子类型外观区别明显，战斗更具视觉冲击力

### 版本 3.7 - 风火轮增强版
- ⏱️ **风火轮持续时间限制** - 风火轮技能现在有5秒的持续时间限制，时间结束后自动进入冷却
- 🔴 **敌人子弹红色显示** - 所有敌人发射的子弹现在显示为红色，提升视觉识别度
- 🔥 **风火轮视觉增强** - 风火轮圆圈尺寸增大一倍，并添加红色连接线效果
- 🔢 **数值显示优化** - 修复伤害、经验和生命值显示小数点的问题，现在显示为整数
- ⚖️ **技能平衡性** - 风火轮技能不再无限持续，增加了策略性使用的考量
- 👁️ **视觉清晰度** - 红色敌人子弹更容易识别和躲避，界面数值更加简洁易读

### 版本 3.6.3 - 视觉增强版
- 📊 **数值显示放大3倍** - 伤害、经验、暴击等数值显示大小增加3倍，更清晰可见
- 🎭 **动态数值动画** - 数值显示添加随机摆动、水平移动和轻微抖动效果，更具生命力
- 🌸 **天雨散花技能** - 当400像素范围内有8个以上敌人时，15%概率触发8方向散射攻击
- ✨ **散射子弹特效** - 散射子弹具有青色发光效果，速度更快、半径更小、伤害为80%
- 🎨 **怪物多样化** - 20%概率生成大体积怪物(1.2-1.8倍)，15%概率生成高速怪物(1.3-1.7倍速度)
- 🎯 **技能视觉反馈** - 天雨散花触发时显示青色粒子特效和技能提示文字

### 版本 3.6.2 - 暴击系统版
- 💥 **暴击系统** - 为红色泡泡和激光技能添加暴击判定机制
- ✨ **屏幕中央暴击显示** - 暴击时在屏幕中央显示金红渐变的"暴击!"特效
- 🎨 **暴击视觉效果** - 暴击伤害数字使用金色显示，普通伤害保持原色
- 🎯 **动态暴击动画** - 暴击显示具有缩放和透明度渐变动画效果
- ⚡ **激光暴击增强** - 激光技能支持暴击，提供更高伤害输出
- 🔴 **红泡暴击** - 红色泡泡攻击支持暴击判定和视觉反馈

### 版本 3.6 - 语法修复版
- 🐛 **JavaScript语法错误修复** - 修复第5709行多余的右大括号语法错误
- 🔧 **代码结构优化** - 清理不必要的代码块结构，确保语法正确性
- ✅ **语法验证通过** - 消除"Unexpected token '}'"错误，确保游戏正常运行
- 🔥 **风火轮技能** - 玩家周围环绕火焰球，提供持续伤害和防护效果
- ⚡ **激光技能** - 强力激光束攻击，可穿透多个敌人造成大量伤害
- 🌊 **狂潮模式** - 所有怪物攻击欲望变强，战斗节奏更加紧张刺激
- 🎯 **技能系统完善** - 新增多种主动技能，丰富战斗策略

### 版本 3.4 - 性能优化版
- 🚀 **全面性能优化** - 粒子系统、敌人生成、碰撞检测全面优化
- 🎯 **批量渲染系统** - 实现敌人类型批量绘制，大幅提升渲染效率
- 👁️ **视野裁剪完善** - 所有游戏对象应用严格视野检查，只渲染可见内容
- 🔄 **对象池系统** - 为频繁创建的对象实现对象池，减少垃圾回收压力
- ⚡ **帧率提升** - 优化到120fps，更流畅的游戏体验
- 🐛 **错误修复** - 修复粒子渲染错误，消除卡死和崩溃问题
- 💾 **内存优化** - 显著降低内存占用，提升运行稳定性

### 版本 3.0 - 地形系统版
- 🧱 新增石块地形系统 - 坚固不可破坏的障碍物
- 🟫 新增砖块地形系统 - 可被子弹击碎或跳跃撞击破坏
- 💥 砖块破坏特效和粒子系统
- 🎯 完整的地形碰撞检测系统
- 🏆 地形破坏奖励机制（经验和分数）
- 💥 **AOE攻击系统** - 右键释放范围攻击，扩散圈圈效果
- 🤖 **智能友方AI** - 友方球球自动寻找敌人，围绕玩家旋转
- 🔴 **怪物子弹区分** - 怪物子弹显示为红色，便于识别
- ⚡ **动态跟随系统** - 友方球球根据玩家速度智能调整移动
- 🎯 **优化怪物生成** - 修复新区域怪物刷新问题

### 版本 2.0 - 传送怪物版
- ✨ 新增紫色传送球球怪物
- 🎯 蓄力传送攻击机制
- 💫 华丽的传送特效和粒子系统
- 🔧 优化怪物生成算法
- 🗺️ 改进地图跟随系统

### 版本 1.0 - 基础版
- 🎮 基础游戏玩法
- 👾 5种基础怪物类型
- 🏃 冲刺和跳跃系统
- 🌍 基础地图生成

## 🎯 怪物类型

1. **红色球球** - 基础近战怪物，血量和攻击力较高
2. **蓝色球球** - 敏捷型怪物，移动速度快
3. **白色球球** - 自爆型怪物，接近玩家时爆炸
4. **黑色球球** - 重型怪物，具有引力效果
5. **大型红色球球** - Boss级怪物，可散射攻击
6. **旋转球球** - 双球旋转攻击，高伤害
7. **紫色传送球球** - 蓄力传送攻击，战术性强

## 🎮 操作说明

- **WASD** - 移动
- **空格** - 跳跃/二段跳
- **Shift** - 冲刺
- **鼠标左键** - 攻击
- **鼠标右键** - AOE范围攻击（有冷却时间）

## 🚀 如何运行

1. 下载项目文件
2. 在浏览器中打开 `index.html` 或启动本地服务器
3. 开始游戏！

### 本地服务器运行
```bash
# 使用Python启动服务器
python -m http.server 8000

# 然后在浏览器访问
http://localhost:8000
```

## 📁 项目结构

```
球球大冒险/
├── index.html              # 主游戏文件 (版本 3.9.6)
├── gameLogic.js           # 游戏逻辑模块
├── render.js              # 渲染与绘制模块
├── inputHandler.js        # 输入处理模块
├── buffSystem.js          # Buff系统模块
├── utils.js               # 工具函数模块
├── 原型设计/
│   ├── 球球大冒险1.0.html    # 基础版本
│   ├── 球球大冒险2.0.html    # 传送怪物版
│   ├── 球球大冒险3.0.html    # 地形系统版
│   ├── 球球大冒险3.4.html    # 性能优化版
│   ├── 球球大冒险3.6.html    # 语法修复版
│   ├── 球球大冒险3.6.2.html  # 暴击系统版
│   └── 球球大冒险3.6.3.html  # 视觉增强版
├── 概念设计/
│   └── 设计文档
├── README.md
├── CHANGELOG.md
├── trea.md                # 开发记录
└── hs.md                  # 函数定义记录
```

## 🔧 技术特性

- 纯HTML5 Canvas实现
- 60FPS流畅动画
- 动态粒子系统
- 智能相机跟随
- 程序化地图生成
- 实时碰撞检测

---

**开发者**: Trae AI Assistant  
**最后更新**: 2025年1月
